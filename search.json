[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "BM211 Workshop 5: Phylogenetic Trees",
    "section": "",
    "text": "Preface to 2023-24 BM211 Workshop 5: Phylogenetic Trees\nWelcome to the BM211 (Introduction to Microbiology) workshop on phylogenetic trees, for 2023-24.\nThis year is the first presentation of the workshop material in this format, and we would be very grateful to hear feedback by email or through the GitHub repository Issues page.",
    "crumbs": [
      "Preface to {{< var ay >}} BM211 Workshop 5: Phylogenetic Trees"
    ]
  },
  {
    "objectID": "index.html#overview",
    "href": "index.html#overview",
    "title": "BM211 Workshop 5: Phylogenetic Trees",
    "section": "Overview",
    "text": "Overview\nThis workshop asks you to work through some computational exercises to gain some practice visualising and working with phylogenetic trees.\n\n\n\n\n\n\nNote\n\n\n\nPhylogenetic trees are typically constructed after sequence alignment has been performed. You learned about the fundamentals of (pairwise) sequence alignment in BM214 Workshop 2 - slides, workshop. You may find it useful to refresh your memory about pairwise alignment.\n\n\n\n\n\n\n\n\nImportant Note\n\n\n\nThere is new material in this workshop that is not covered in lectures, and this material is examinable. Please take care to reach the text in the expandable callout boxes, as well as that for the workshop activities, to be sure you have understood the topic and obtain full value from the exercises.",
    "crumbs": [
      "Preface to {{< var ay >}} BM211 Workshop 5: Phylogenetic Trees"
    ]
  },
  {
    "objectID": "index.html#learning-objectives",
    "href": "index.html#learning-objectives",
    "title": "BM211 Workshop 5: Phylogenetic Trees",
    "section": "Learning Objectives",
    "text": "Learning Objectives\nBy the end of this workshop, students will be able to:\n[FILL IN TEXT HERE]",
    "crumbs": [
      "Preface to {{< var ay >}} BM211 Workshop 5: Phylogenetic Trees"
    ]
  },
  {
    "objectID": "index.html#assessment",
    "href": "index.html#assessment",
    "title": "BM211 Workshop 5: Phylogenetic Trees",
    "section": "Assessment",
    "text": "Assessment\nThe workshop is not formally assessed although, as noted above, all the material contained in the workshop is examinable. [FILL IN TEXT HERE]\n\n\n\n\n\n\nImportant\n\n\n\nThere are three formative exercises, one for each exercise in the workshop, and they can be found on the workshop MyPlace page. You should complete these as part of the workshop.",
    "crumbs": [
      "Preface to {{< var ay >}} BM211 Workshop 5: Phylogenetic Trees"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  Introduction",
    "section": "",
    "text": "1.1 Working with phylogenetic trees\nWhen you use a software tool to build, or you otherwise acquire, phylogenetic tree data it will be in a (plain text) file. This file will be in one of a number of more or less cryptic file formats, such as:\nThese files can be cryptic to read, as a human. For example, the first newick format file we will work with has these contents:\nIt is difficult, as a human, to read a file like this and understand the structure of the tree it describes, so we almost always use computational tools to open these files and visualise the trees they represent.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#working-with-phylogenetic-trees",
    "href": "intro.html#working-with-phylogenetic-trees",
    "title": "1  Introduction",
    "section": "",
    "text": "newick, file ending .new, .nwk, .newick\nNEXUS, file ending .nex, .nexus\nphylip, file ending .phy, .phylip\n\n\n(((((((A:4,B:4):6,C:5):8,D:6):3,E:21):10,((F:4,G:12):14,H:8):13):13,((I:5,J:2):30,(K:11,L:11):2):17):4,M:56);\n\n\n\n\n\n\n\nFigure 1.1: A genAI representation of “phylogenetic tree as a real tree.”\n\n\n\n\n1.1.1 Phylogenetic tree visualisation software\nA number of software packages are available to visualise, edit, and refine phylogenetic tree files for reports and publications. Some of these can be downloaded and run on your own computer, such as:\n\nfigtree this is the one I use most often - LP\ndendroscope\n\nbut the interactive Tree of Life (iTol) service allows you, once you register and sign in, to edit trees directly in the browser. Traditionally, phylogenetic trees have been visualised using independent software tools like these.\n\n\n\n\n\n\nCaution\n\n\n\nIn this workshop we will be using the online iToL service to visualise and interpret trees.\n\n\nThe R software ecosystem is a very powerful tool for computational biology and bioinformatics work, encompassing sequence analysis and genomics, transcriptomic and evolutionary analyses, with excellent visualisation capabilities. As R is also a programming language, large parts of the analysis can be automated and made reproducible, which is an advantage over independent tools, and a factor in the growing popularity of this approach. Basic competence and skills in R are in high demand in academia and industry.\n\n\n\n\n\n\nNote\n\n\n\nYou can produce equivalent trees to those you will produce in these exercises using standalone tools like figtree and dendroscope. Some tree visualisations can only be achieved in specialised packages, or with tools like ggtree.\nggtree is an R packages that extends the ggplot2 data visualisation package to visualise and annotate phylogenetic trees (or any other tree-like structure!).\n\nggtree homepage\nThe ggtree book",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "loading-tree.html",
    "href": "loading-tree.html",
    "title": "2  Loading a Phylogenetic Tree",
    "section": "",
    "text": "2.1 Introduction\nAs noted in Chapter 1, you will generally encounter phylogenetic trees as a plain text file in one of a handful of common file formats, such as:\nWhichever software tool you use to read and visualise your tree, you will need to load the data into that tool. In iToL you would need to upload the data to the server. In figtree or dendroscope you would open the file through a dialogue box. Using ggtree in R, you would write code to open the file and run commands to visualise it.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Loading a Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "loading-tree.html#introduction",
    "href": "loading-tree.html#introduction",
    "title": "2  Loading a Phylogenetic Tree",
    "section": "",
    "text": "newick, file ending .new, .nwk, .newick\nNEXUS, file ending .nex, .nexus\nphylip, file ending .phy, .phylip\n\n\n\n\n\n\n\n\nNote\n\n\n\nIn this workshop we will be using the online iToL service to visualise and interpret trees. This does not require you to install any software on your machine. The iToL service is available at the link below.\n\niToL\n\n\n\n\n\n\n\n\n\nFigure 2.1: iToL landing page at https://itol.embl.de.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Loading a Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "loading-tree.html#load-your-tree-data",
    "href": "loading-tree.html#load-your-tree-data",
    "title": "2  Loading a Phylogenetic Tree",
    "section": "2.2 Load your tree data",
    "text": "2.2 Load your tree data\nYour tree data is in a file called tree_newick.nwk. This tree file describes a phylogeny with 13 samples, and it should be downloaded to your computer from the link below.\n\ntree_newick.nwk\n\n\n\n\n\n\n\nTask\n\n\n\nUpload the tree file tree_newick.nwk to iToL.\n\n\n\n\n\n\n\n\nI need a hint!\n\n\n\n\n\n\nClick on the Upload button (Figure 2.2) to see the tree file upload page\nFollow the instructions on the page\n\n\n\n\n\n\n\nFigure 2.2: iTol tree file upload button.\n\n\n\n\n\n\n\n\n\n\n\n\nHelp! I’m stuck!\n\n\n\n\n\n\nClick on the Upload button (Figure 2.2) to see the tree file upload page\nEnter a name for the tree in the Tree name: field.\nClick on the Browse button, and select your downloaded tree_newick.nwk file. The name of the file will appear next to the button.\nClick on the Upload button\n\n\n\n\n\n\n\nFigure 2.3: iToL tree file upload page.\n\n\n\n\n\n\n\n\n\n\n\n\nCheck your result\n\n\n\n\n\nAfter uploading the tree, iTol should present the default tree view, as in (Figure 2.4).\n\n\n\n\n\n\nFigure 2.4: The default iToL view of the uploaded tree_newick.nwk tree.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Loading a Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "loading-tree.html#understanding-your-tree",
    "href": "loading-tree.html#understanding-your-tree",
    "title": "2  Loading a Phylogenetic Tree",
    "section": "2.3 Understanding your tree",
    "text": "2.3 Understanding your tree\nConsidering the newick file contents you saw in Chapter 1 (and shown below), you might expect that the tree shows relationships between species represented by the letters A-M in that file:\n(((((((A:4,B:4):6,C:5):8,D:6):3,E:21):10,((F:4,G:12):14,H:8):13):13,((I:5,J:2):30,(K:11,L:11):2):17):4,M:56);\nThe tree iTol presents at first (Figure 2.5) shows these relationships.\n\n\n\n\n\n\nFigure 2.5: Rectangular phylogram representation of the tree_newick.nwk file.\n\n\n\n\nthe tree is a set of bifurcating branches that spread out from the last common ancestor (LCA) and represent an estimated evolutionary history\nthis is a rooted tree, so the last common ancestor (LCA) is considered to be represented at the very far left of the tree, at its root\n\nin this tree, ancestors are on the left, and descendants are on the right\n\nthe horizontal dimension in this plot shows the amount of genetic change since the LCA - less change towards the left-hand side, more towards the right\n\nthis tree is a phylogram, which means that the lengths of the branches are meaningful and represent the amount of genetic change\n\n\n\n\n\n\n\n\nNote\n\n\n\nBranch lengths are usually drawn in units of nucleotide substitutions per site - the estimated total number of nucleotide substitutions, divided by (normalised to) the length of the sequence.\nYou may sometimes see alternative units being used, such as estimated time, or the percentage of sites that have changed.\n\n\n\n\n\n\n\n\nQuestion 01\n\n\n\n\n\nIn Figure 2.5 which species shows the most genetic change since the LCA?\n\nA\nE\nG\nK\n\n\n\n\n\n\n\n\n\n\nAnswer 01\n\n\n\n\n\nThe total distance from the LCA to the leaf node for a species represents the total amount of genetic change. More straightforwardly here, the species whose leaf node is farthest to the right in Figure 2.5 has accumulated the most genetic change since the LCA. Of the four options presented, the species with greatest genetic change since the LCA is G.\n\n\n\n\n2.3.1 Trees and time\nThe general relationship between this phylogram and time is shown in Figure 2.6.\n\n\n\n\n\n\nFigure 2.6: iToL phylogram annotated with root, leaves, bifurcations, and the relationship between ancestors and descendents.\n\n\n\nAs the tree represents genetic change, and the rate of genetic change may not be constant in all sequences or organisms, we can’t immediately interpret branch lengths as time. The best we can sometimes do is - when the sequences/organisms used to build the tree are known to exist now - say that the leaves of the tree approximately represent the current date.\n\n\n\n\n\n\nNote\n\n\n\nThere are phylogenetic techniques that allow us to convert genetic distances into approximate times, but they are beyond the scope of this workshop.\n\n\n\ncurrently existing species (A-M) - the input for building the tree - are shown at the leaves (or leaf nodes) of the tree, at the ends of the branches\nthe branching events (bifurcations) show how evolutionary lineages split, as the amount of genetic change increases from left to right; they represent events in evolution where a population divides into two subgroups with different genetic histories\n\nin a biological context, this process is often referred to as speciation\nthe order of bifurcation can be interpreted as the order in which speciation events occurred\n\nthe amount of genetic change between branching events is represented by the length of the branch that separates them; the scale bar allows you to interpret the branch length quantitatively\n\n\n\n\n\n\n\nQuestion 02\n\n\n\n\n\nFigure 2.5 implies that which speciation event was the earliest?\n\nthe speciation separating A and B\nthe speciation separating B and C\nthe speciation separating B and D\nthe speciation separating C and E\n\n\n\n\n\n\n\n\n\n\nAnswer 02\n\n\n\n\n\nWe have to be careful with the interpretation because the lengths of branches represent genetic change, not time. However, moving from left to right we can see that A, B, C, D, and E derived from a single common ancestor. The order in which the individual species emerged is the order of speciations from left to right in this tree. So, E diverged first, then D, C, B and A in that order. The earliest specietion is the one involving species E, so the answer is the speciation separating C and E.\n\n\n\n\n\n2.3.2 Ancestry and history\nPhylogenetic trees represent patterns of shared ancestry and history between lineages. For instance, in Figure 2.7 common and unique ancestors of A, B and C are indicated, as are common and unique histories of I and J.\n\n\n\n\n\n\nFigure 2.7: iToL phylogram annotated with unique and shared ancestries and histories. Ancestors are single points on a branch (represented here as boxes), whereas histories are the entire set of ancestors represented by a branch.\n\n\n\n\n\n\n\n\n\nQuestion 03\n\n\n\n\n\nIn Figure 2.5 which of the following accumulated the greatest amount of genetic change?\n\nthe unique history of E\nthe shared history of I and J\nthe shared history of I, J, K, and L\nthe unique history of D\n\n\n\n\n\n\n\n\n\n\nAnswer 03\n\n\n\n\n\nFrom those listed, the branch that accumulated the most genetic change is the longest of the branches. The shared history of I and J is the longest of these, so has accumulated the most genetic change.\n\n\n\n\n\n2.3.3 Clades\nA clade is a grouping on the tree that includes a common ancestor and all of its descendants. We call a group with these properties monpphyletic (i.e. it comprises a single phylum). Figure 2.8 shows examples of clades in the iToL tree you generated.\n\n\n\n\n\n\nFigure 2.8: iToL phylogram annotated with clades, groupings on the tree that include a common ancestor and all its descendants. Clades can be nested inside each other as a hierarchy. Clade4 (A, B, C) is completely contained within Clade3 (A, B, C, D, E).\n\n\n\n\n\n\n\n\n\nQuestion 04\n\n\n\n\n\nIn Figure 2.5 which of the following groups of leaf nodes form a clade?\n\n(J, K, L)\n(F, G, H)\n(D, E)\n(K, L)\n\n\nall of the groups form a clade\nonly groups 1 and 4 form clades\nonly groups 2 and 4 form clades\nonly group 1 forms a clade\nonly group 2 forms a clade\nonly group 3 forms a clade\nonly group 4 forms a clade\nonly groups 2 and 3 form clades\nnone of the groups form a clade\n\n\n\n\n\n\n\n\n\n\nAnswer 04\n\n\n\n\n\nGroup 1, (J, K, L) does not form a clade because the common ancestor of these species also has I as a descendent, and it is not included in the group.\nGroup 2, (F, G, H) forms a clade (see Figure 2.8).\nGroup 3, (D, E) does not form a clade because the common ancestor of these species also has A , B, and C as descendents, and they are not included in the group.\nGroup 4, (K, L) does form a clade as K, L and all descendants from their common ancestor are included.\nThus, the answer is only groups 2 and 4 form clades.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Loading a Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "loading-tree.html#myplace-quiz",
    "href": "loading-tree.html#myplace-quiz",
    "title": "2  Loading a Phylogenetic Tree",
    "section": "2.4 MyPlace Quiz",
    "text": "2.4 MyPlace Quiz\n\n\n\n\n\n\nImportant\n\n\n\nPlease answer the questions below in the formative quiz on MyPlace\n\nMyPlace formative quiz",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Loading a Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "itol-visualisation-1.html",
    "href": "itol-visualisation-1.html",
    "title": "3  Types of Phylogenetic Tree",
    "section": "",
    "text": "3.1 Introduction\nIn this section, we will work through some of the visualisation options available in iToL to explore how the same phylogenetic tree can be presented to accentuate different aspects of the data. These options are controlled through the control panel (Figure 3.1).",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Types of Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "itol-visualisation-1.html#introduction",
    "href": "itol-visualisation-1.html#introduction",
    "title": "3  Types of Phylogenetic Tree",
    "section": "",
    "text": "Figure 3.1: The iTol control panel. Options in this menu allow you to change the way the tree is visualised.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Types of Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "itol-visualisation-1.html#cladograms-and-phylograms",
    "href": "itol-visualisation-1.html#cladograms-and-phylograms",
    "title": "3  Types of Phylogenetic Tree",
    "section": "3.2 Cladograms and Phylograms",
    "text": "3.2 Cladograms and Phylograms\nThe default tree presented by iToL (Figure 2.5) is a rectangular tree.\n\n\n\n\n\n\nNote\n\n\n\nYou can see from Figure 3.1 that the Rectangular mode is selected by default.\n\n\nBroadly-speaking this means that the tree looks “rectangular” (it has lots of right angles) in a way that other tree representations do not. More specifically, every bifurcation is presented as a kind of “T-junction” where the ancestral lineage splits into two descendant lineages that leave the bifurcation at right angles (?fig-tree-newick-05)\n\n\n\n\n\n\nFigure 3.2: The default iToL view of the uploaded tree_newick.nwk tree is a rectangular tree - specifically a phylogram.\n\n\n\nThere are two forms of rectangular tree.\n\n\n\n\n\n\nTip\n\n\n\n\na tree in which the branch lengths are proportional to the genetic change represented by the tree - this is called a phylogram\na tree in which the branch lengths carry no meaning, or are an arbitrary length - this is called a cladogram\n\n\n\nYou can toggle between these two forms of rectangular tree in iTol by changing the Branch lengths: option from Use to Ignore. A cladogram shows the order of branching events, but does not provide visual information about the genetic change between nodes on the tree (branching events or leaves).\n\n\n\n\n\n\nTip\n\n\n\nThe order of branching events in a tree is referred to as its topology.\n\n\n\n\n\n\n\n\nFigure 3.3: By setting the Branch lengths: option to ignore, iToL will show a rectangular cladogram.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Types of Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "itol-visualisation-1.html#tree-rotation",
    "href": "itol-visualisation-1.html#tree-rotation",
    "title": "3  Types of Phylogenetic Tree",
    "section": "3.3 Tree rotation",
    "text": "3.3 Tree rotation\nRotating a tree does not change its content or the relationships it describes. All four trees in Figure 3.5 show exactly the same information. These trees were generated by setting the Rotation value in the iToL control panel (Figure 3.1).\n\n\n\n\n\n\nTip\n\n\n\nChanging the scaling of the tree (stretching or compressing it in any direction) also does not change the information presented. The trees in ?fig-four-rotated trees were scaled horizontally by 50% using the Advanced tab of the iToL control panel (Figure 3.4).\n\n\n\n\n\n\nFigure 3.4: The advanced tab of the iTol control panel. Options in this menu allow you to change the way the tree is visualised.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n(a) Default rotation, 0 degrees\n\n\n\n\n\n\n\n\n\n\n\n(b) 90 degrees rotation\n\n\n\n\n\n\n\n\n\n\n\n\n\n(c) 180 degrees rotation\n\n\n\n\n\n\n\n\n\n\n\n(d) 270 degrees rotation\n\n\n\n\n\n\n\nFigure 3.5: The same cladogram, rotated through 90, 180, and 270 degrees. The tree shows exactly the same information in each rotation.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Types of Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "itol-visualisation-1.html#rotating-clades",
    "href": "itol-visualisation-1.html#rotating-clades",
    "title": "3  Types of Phylogenetic Tree",
    "section": "3.4 Rotating clades",
    "text": "3.4 Rotating clades\nRotating the members of a clade around their common ancestor also does not affect the content of the tree - and specifically leaves its topology unchanged - even if it makes the tree appear visually quite different. The four trees in Figure 3.6 have exactly the same topology.\n\n\n\n\n\n\n\n\n\n\n\n(a) The phylogram prior to any rotation, with the clade containing (I, J, K, and L) highlighted.\n\n\n\n\n\n\n\n\n\n\n\n(b) The phylogram after rotating the clade containing (I, J, K, and L) around their common ancestor. This does not change the topology of the tree.\n\n\n\n\n\n\n\n\n\n\n\n\n\n(c) The phylogram after rotating the clade containing (F, G, and H) around their common ancestor. This does not change the topology of the tree.\n\n\n\n\n\n\n\n\n\n\n\n(d) The phylogram after rotating the clade containing (A, B, C, and D) around their common ancestor. This does not change the topology of the tree.\n\n\n\n\n\n\n\nFigure 3.6: The same cladogram, progressively rotating clades so that node order increases along the tree. The tree shows exactly the same information in each rotation - the topology (branching order) of the tree remains unchanged.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Types of Phylogenetic Tree</span>"
    ]
  },
  {
    "objectID": "itol-visualisation-1.html#non-rectangular-trees",
    "href": "itol-visualisation-1.html#non-rectangular-trees",
    "title": "3  Types of Phylogenetic Tree",
    "section": "3.5 Non-rectangular trees",
    "text": "3.5 Non-rectangular trees\nPhylogenetic trees do not need to be rectangular and, even if drawn using different forms, still present the same information as their rectangular counterparts.\n\n3.5.1 Slanted cladogram\nThe angle formed at each branching event doesn’t need to be rectangular (at 90 degrees) - it can be narrower, as in a slanted cladogram. Figure 3.7 shows rectangular and slanted cladograms of the same tree. Being cladograms they provide only topology information, and this is the same in both renderings.\n\n\n\n\n\n\n\n\n\n\n\n(a) Rectangular cladogram.\n\n\n\n\n\n\n\n\n\n\n\n(b) Slanted cladogram.\n\n\n\n\n\n\n\nFigure 3.7: A rectangular and a slanted cladogram of the same phylogenetic tree, presenting identical evolutionary information.\n\n\n\n\n\n3.5.2 Circular phylogram\nIt is increasingly common, as datasets increase in size, to see circular phylograms in publications. These place the root at the centre of a circle and show the branches as radii pointing away from the centre as genetic changes increase.\nRendering a tree in circular form does not change the information being presented, in comparison with a rectangular phylogram, as can be seen in Figure 3.8.\n\n\n\n\n\n\n\n\n\n\n\n(a) Rectangular phylogram\n\n\n\n\n\n\n\n\n\n\n\n(b) Circular phylogram\n\n\n\n\n\n\n\nFigure 3.8: A rectangular and a circular phylogram of the same phylogenetic tree, presenting identical evolutionary information.\n\n\n\n\n\n\n\n\n\nPros and cons of circular phylograms\n\n\n\nPros\n\nCircular trees are efficient with space\nCircular trees are especially useful for fitting large trees into a small space, such as a journal page.\n\nCons\n\nIt can be difficult to read the labels on circular trees easily\nDue to the way they are presented, especially for trees with lots of data, it can be difficult to see the branching order of nodes close to the root.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Types of Phylogenetic Tree</span>"
    ]
  }
]